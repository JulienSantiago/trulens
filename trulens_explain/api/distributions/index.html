
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Evaluate and track LLM applications. Explain Deep Neural Nets.">
      
      
      
      
        <link rel="prev" href="../quantities/">
      
      
        <link rel="next" href="../visualizations/">
      
      <link rel="icon" href="../../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.1.4">
    
    
      
        <title>Distributions - TruLens</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.240905d7.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../../stylesheets/cover.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="trulens" data-md-color-primary="" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#distributions-of-interest" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="TruLens" class="md-header__button md-logo" aria-label="TruLens" data-md-component="logo">
      
  <img src="../../../img/squid.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            TruLens
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Distributions
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/truera/trulens" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    truera/trulens
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../welcome/" class="md-tabs__link">
      Welcome to TruLens!
    </a>
  </li>

      
        
  
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../../trulens_eval/install/" class="md-tabs__link">
        Eval
      </a>
    </li>
  

  

      
        
  
  
    
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../install/" class="md-tabs__link md-tabs__link--active">
        Explain
      </a>
    </li>
  

  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="TruLens" class="md-nav__button md-logo" aria-label="TruLens" data-md-component="logo">
      
  <img src="../../../img/squid.png" alt="logo">

    </a>
    TruLens
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/truera/trulens" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    truera/trulens
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../welcome/" class="md-nav__link">
        Welcome to TruLens!
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Eval
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Eval
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
          Getting Started
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_1">
          <span class="md-nav__icon md-icon"></span>
          Getting Started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/install/" class="md-nav__link">
        🚀 Installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_2" >
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_1_2" id="__nav_3_1_2_label" tabindex="0">
          ⚡ Quickstarts
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_1_2">
          <span class="md-nav__icon md-icon"></span>
          ⚡ Quickstarts
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/quickstart/" class="md-nav__link">
        TruLens Quickstart
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/langchain_quickstart/" class="md-nav__link">
        Langchain Quickstart
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/llama_index_quickstart/" class="md-nav__link">
        Llama-Index Quickstart
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/text2text_quickstart/" class="md-nav__link">
        Text to Text Quickstart
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/groundtruth_evals/" class="md-nav__link">
        Ground Truth Evaluations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/human_feedback/" class="md-nav__link">
        Human Feedback Quickstart
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_3" >
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_1_3" id="__nav_3_1_3_label" tabindex="0">
          🧠 Core Concepts
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_1_3">
          <span class="md-nav__icon md-icon"></span>
          🧠 Core Concepts
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/core_concepts_feedback_functions/" class="md-nav__link">
        Feedback Functions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/core_concepts_rag_triad/" class="md-nav__link">
        RAG Triad
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/core_concepts_honest_harmless_helpful_evals/" class="md-nav__link">
        Honest, Harmless, Helpful Evals
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
          Evaluation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          Evaluation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_1" >
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_2_1" id="__nav_3_2_1_label" tabindex="0">
          🎯 Feedback Functions
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_2_1">
          <span class="md-nav__icon md-icon"></span>
          🎯 Feedback Functions
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/function_definitions/" class="md-nav__link">
        Feedback Function Definitions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/feedback_function_guide/" class="md-nav__link">
        Feedback Function Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/custom_feedback_functions/" class="md-nav__link">
        Custom Functions
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_1_4" >
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_2_1_4" id="__nav_3_2_1_4_label" tabindex="0">
          Smoke Tests
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_2_1_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_2_1_4">
          <span class="md-nav__icon md-icon"></span>
          Smoke Tests
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/answer_relevance_smoke_tests/" class="md-nav__link">
        Answer Relevance
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/context_relevance_smoke_tests/" class="md-nav__link">
        Context Relevance
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/groundedness_smoke_tests/" class="md-nav__link">
        Groundedness
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_2" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_2_2" id="__nav_3_2_2_label" tabindex="0">
          📚 API Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_2_2">
          <span class="md-nav__icon md-icon"></span>
          📚 API Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/api/feedback/" class="md-nav__link">
        Feedback Functions
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_2_2" >
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_2_2_2" id="__nav_3_2_2_2_label" tabindex="0">
          Providers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_3_2_2_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_2_2_2">
          <span class="md-nav__icon md-icon"></span>
          Providers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/api/openai_provider/" class="md-nav__link">
        OpenAI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/api/azureopenai_provider/" class="md-nav__link">
        AzureOpenAI
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/api/bedrock_provider/" class="md-nav__link">
        AWS Bedrock
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/api/huggingface_provider/" class="md-nav__link">
        HuggingFace
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/api/litellm_provider/" class="md-nav__link">
        LiteLLM
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
          Tracking
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_3">
          <span class="md-nav__icon md-icon"></span>
          Tracking
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_1" >
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_3_1" id="__nav_3_3_1_label" tabindex="0">
          🎺 Instrumentation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_3_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_3_1">
          <span class="md-nav__icon md-icon"></span>
          🎺 Instrumentation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/basic_instrumentation/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/langchain_instrumentation/" class="md-nav__link">
        LangChain Integration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/llama_index_instrumentation/" class="md-nav__link">
        Llama-Index Integration
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_2" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_3_2" id="__nav_3_3_2_label" tabindex="0">
          🚚 Logging
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_3_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_3_2">
          <span class="md-nav__icon md-icon"></span>
          🚚 Logging
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/where_to_log/" class="md-nav__link">
        Where to Log
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/logging/" class="md-nav__link">
        Logging Methods
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_3" >
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_3_3" id="__nav_3_3_3_label" tabindex="0">
          📚 API Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_3_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_3_3">
          <span class="md-nav__icon md-icon"></span>
          📚 API Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/api/tru/" class="md-nav__link">
        Tru
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/api/trubasicapp/" class="md-nav__link">
        TruBasicApp
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/api/truchain/" class="md-nav__link">
        TruChain
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/api/trullama/" class="md-nav__link">
        TruLlama
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/api/trucustom/" class="md-nav__link">
        TruCustom
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
          Guides
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_4">
          <span class="md-nav__icon md-icon"></span>
          Guides
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4_1" >
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_4_1" id="__nav_3_4_1_label" tabindex="0">
          🔍 Use Cases
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_4_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_4_1">
          <span class="md-nav__icon md-icon"></span>
          🔍 Use Cases
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/use_cases_any/" class="md-nav__link">
        Any LLM App
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/use_cases_rag/" class="md-nav__link">
        RAGs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/use_cases_agent/" class="md-nav__link">
        LLM Agents
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/use_cases_production/" class="md-nav__link">
        Dev to Prod
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
          Contributing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3_5">
          <span class="md-nav__icon md-icon"></span>
          Contributing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../trulens_eval/CONTRIBUTING/" class="md-nav__link">
        🤝 Contribution Guidelines
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Explain
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Explain
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
          Getting Started
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_1">
          <span class="md-nav__icon md-icon"></span>
          Getting Started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../install/" class="md-nav__link">
        🚀 Installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../quickstart/" class="md-nav__link">
        ⚡ Quickstart
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../attribution_parameterization/" class="md-nav__link">
        Attributions
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" checked>
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
          API Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_4_3">
          <span class="md-nav__icon md-icon"></span>
          API Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../attribution/" class="md-nav__link">
        Attribution
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../model_wrappers/" class="md-nav__link">
        Models
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../slices/" class="md-nav__link">
        Slices
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../quantities/" class="md-nav__link">
        Quantities
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Distributions
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Distributions
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.distributions" class="md-nav__link">
    trulens_explain.trulens.nn.distributions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.distributions.DoI" class="md-nav__link">
    DoI
  </a>
  
    <nav class="md-nav" aria-label="DoI">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.distributions.DoI.__call__" class="md-nav__link">
    __call__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.distributions.DoI.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.distributions.DoI.cut" class="md-nav__link">
    cut()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.distributions.DoI.get_activation_multiplier" class="md-nav__link">
    get_activation_multiplier()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.distributions.DoiCutSupportError" class="md-nav__link">
    DoiCutSupportError
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.distributions.GaussianDoi" class="md-nav__link">
    GaussianDoi
  </a>
  
    <nav class="md-nav" aria-label="GaussianDoi">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.distributions.GaussianDoi.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.distributions.LinearDoi" class="md-nav__link">
    LinearDoi
  </a>
  
    <nav class="md-nav" aria-label="LinearDoi">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.distributions.LinearDoi.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.distributions.LinearDoi.get_activation_multiplier" class="md-nav__link">
    get_activation_multiplier()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.distributions.PointDoi" class="md-nav__link">
    PointDoi
  </a>
  
    <nav class="md-nav" aria-label="PointDoi">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.distributions.PointDoi.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../visualizations/" class="md-nav__link">
        Visualizations
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.distributions" class="md-nav__link">
    trulens_explain.trulens.nn.distributions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.distributions.DoI" class="md-nav__link">
    DoI
  </a>
  
    <nav class="md-nav" aria-label="DoI">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.distributions.DoI.__call__" class="md-nav__link">
    __call__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.distributions.DoI.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.distributions.DoI.cut" class="md-nav__link">
    cut()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.distributions.DoI.get_activation_multiplier" class="md-nav__link">
    get_activation_multiplier()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.distributions.DoiCutSupportError" class="md-nav__link">
    DoiCutSupportError
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.distributions.GaussianDoi" class="md-nav__link">
    GaussianDoi
  </a>
  
    <nav class="md-nav" aria-label="GaussianDoi">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.distributions.GaussianDoi.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.distributions.LinearDoi" class="md-nav__link">
    LinearDoi
  </a>
  
    <nav class="md-nav" aria-label="LinearDoi">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.distributions.LinearDoi.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.distributions.LinearDoi.get_activation_multiplier" class="md-nav__link">
    get_activation_multiplier()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.distributions.PointDoi" class="md-nav__link">
    PointDoi
  </a>
  
    <nav class="md-nav" aria-label="PointDoi">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trulens_explain.trulens.nn.distributions.PointDoi.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="distributions-of-interest">Distributions of Interest<a class="headerlink" href="#distributions-of-interest" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">


<a id="trulens_explain.trulens.nn.distributions"></a>
  <div class="doc doc-contents first">
  
      <p>The distribution of interest lets us specify the set of samples over which we 
want our explanations to be faithful. In some cases, we may want to explain the 
model’s behavior on a particular record, whereas other times we may be 
interested in a more general behavior over a distribution of samples.</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="trulens_explain.trulens.nn.distributions.DoI" class="doc doc-heading">
        <code>DoI</code>


<a href="#trulens_explain.trulens.nn.distributions.DoI" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><span title="abc.ABC">AbstractBaseClass</span></code></p>

  
      <p>Interface for distributions of interest. The <em>Distribution of Interest</em> 
(DoI) specifies the samples over which an attribution method is 
aggregated.</p>


        <details class="quote">
          <summary>Source code in <code>trulens_explain/trulens/nn/distributions.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">DoI</span><span class="p">(</span><span class="n">AbstractBaseClass</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Interface for distributions of interest. The *Distribution of Interest* </span>
<span class="sd">    (DoI) specifies the samples over which an attribution method is </span>
<span class="sd">    aggregated.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cut</span><span class="p">:</span> <span class="n">Cut</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;&quot;Initialize DoI</span>

<span class="sd">        Parameters:</span>
<span class="sd">            cut (Cut, optional): </span>
<span class="sd">                The Cut in which the DoI will be applied. If `None`, the DoI will be</span>
<span class="sd">                applied to the input. otherwise, the distribution should be applied</span>
<span class="sd">                to the latent space defined by the cut. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cut</span> <span class="o">=</span> <span class="n">cut</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">render_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;_cut&#39;</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">_wrap_public_call</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="n">Inputs</span><span class="p">[</span><span class="n">TensorLike</span><span class="p">],</span> <span class="o">*</span><span class="p">,</span> <span class="n">model_inputs</span><span class="p">:</span> <span class="n">ModelInputs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Inputs</span><span class="p">[</span><span class="n">Uniform</span><span class="p">[</span><span class="n">TensorLike</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Same as __call__ but input and output types are more specific and</span>
<span class="sd">        less permissive. Formats the inputs for special cases that might be more</span>
<span class="sd">        convenient for the user&#39;s __call__ implementation and formats its return</span>
<span class="sd">        back to the consistent type.&quot;&quot;&quot;</span>

        <span class="n">z</span><span class="p">:</span> <span class="n">Inputs</span><span class="p">[</span><span class="n">TensorLike</span><span class="p">]</span> <span class="o">=</span> <span class="n">om_of_many</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">accepts_model_inputs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="fm">__call__</span><span class="p">):</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">model_inputs</span><span class="o">=</span><span class="n">model_inputs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="c1"># Wrap the public doi generator with appropriate type aliases.</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ret</span><span class="p">,</span> <span class="n">DATA_CONTAINER_TYPE</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ret</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">DATA_CONTAINER_TYPE</span><span class="p">):</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="n">Inputs</span><span class="p">(</span><span class="n">Uniform</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ret</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="n">Uniform</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>

            <span class="n">ret</span><span class="p">:</span> <span class="n">Inputs</span><span class="p">[</span><span class="n">Uniform</span><span class="p">[</span><span class="n">TensorLike</span><span class="p">]]</span> <span class="o">=</span> <span class="n">many_of_om</span><span class="p">(</span>
                <span class="n">ret</span><span class="p">,</span> <span class="n">innertype</span><span class="o">=</span><span class="n">Uniform</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ret</span><span class="p">:</span> <span class="n">ArgsLike</span> <span class="o">=</span> <span class="p">[</span><span class="n">ret</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">z</span><span class="p">:</span> <span class="n">OM</span><span class="p">[</span><span class="n">Inputs</span><span class="p">,</span> <span class="n">TensorLike</span><span class="p">],</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">model_inputs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ModelInputs</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OM</span><span class="p">[</span><span class="n">Inputs</span><span class="p">,</span> <span class="n">Uniform</span><span class="p">[</span><span class="n">TensorLike</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the distribution of interest from an initial point. If z:</span>
<span class="sd">        TensorLike is given, we assume there is only 1 input to the DoI layer. If</span>
<span class="sd">        z: List[TensorLike] is given, it provides all of the inputs to the DoI</span>
<span class="sd">        layer. </span>

<span class="sd">        Either way, we always return List[List[TensorLike]] (alias</span>
<span class="sd">        Inputs[Uniform[TensorLike]]) with outer list spanning layer inputs, and</span>
<span class="sd">        inner list spanning a distribution&#39;s instance.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            z:</span>
<span class="sd">                Input point from which the distribution is derived. If</span>
<span class="sd">                list/tuple, the point is defined by multiple tensors.</span>
<span class="sd">            model_inputs:</span>
<span class="sd">                Optional wrapped model input arguments that produce value z at</span>
<span class="sd">                cut.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List of points which are all assigned equal probability mass in the</span>
<span class="sd">            distribution of interest, i.e., the distribution of interest is a</span>
<span class="sd">            discrete, uniform distribution over the list of returned points. If</span>
<span class="sd">            z is multi-input, returns a distribution for each input.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="c1"># @property</span>
    <span class="k">def</span> <span class="nf">cut</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Cut</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns:</span>
<span class="sd">            The Cut in which the DoI will be applied. If `None`, the DoI will be</span>
<span class="sd">            applied to the input. otherwise, the distribution should be applied</span>
<span class="sd">            to the latent space defined by the cut. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cut</span>

    <span class="k">def</span> <span class="nf">_wrap_public_get_activation_multiplier</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">activation</span><span class="p">:</span> <span class="n">Inputs</span><span class="p">[</span><span class="n">TensorLike</span><span class="p">],</span> <span class="o">*</span><span class="p">,</span> <span class="n">model_inputs</span><span class="p">:</span> <span class="n">ModelInputs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Inputs</span><span class="p">[</span><span class="n">TensorLike</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Same as get_activation_multiplier but without &quot;one-or-more&quot;. &quot;&quot;&quot;</span>

        <span class="n">activations</span><span class="p">:</span> <span class="n">OM</span><span class="p">[</span><span class="n">Inputs</span><span class="p">,</span> <span class="n">TensorLike</span><span class="p">]</span> <span class="o">=</span> <span class="n">om_of_many</span><span class="p">(</span><span class="n">activation</span><span class="p">)</span>

        <span class="c1"># get_activation_multiplier is public</span>
        <span class="k">if</span> <span class="n">accepts_model_inputs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_activation_multiplier</span><span class="p">):</span>
            <span class="n">ret</span><span class="p">:</span> <span class="n">OM</span><span class="p">[</span><span class="n">Inputs</span><span class="p">,</span> <span class="n">TensorLike</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_activation_multiplier</span><span class="p">(</span>
                <span class="n">activations</span><span class="p">,</span> <span class="n">model_inputs</span><span class="o">=</span><span class="n">model_inputs</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ret</span><span class="p">:</span> <span class="n">OM</span><span class="p">[</span><span class="n">Inputs</span><span class="p">,</span>
                    <span class="n">TensorLike</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_activation_multiplier</span><span class="p">(</span><span class="n">activations</span><span class="p">)</span>

        <span class="n">ret</span><span class="p">:</span> <span class="n">Inputs</span><span class="p">[</span><span class="n">TensorLike</span><span class="p">]</span> <span class="o">=</span> <span class="n">many_of_om</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">def</span> <span class="nf">get_activation_multiplier</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">activation</span><span class="p">:</span> <span class="n">OM</span><span class="p">[</span><span class="n">Inputs</span><span class="p">,</span> <span class="n">TensorLike</span><span class="p">],</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">model_inputs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ModelInputs</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OM</span><span class="p">[</span><span class="n">Inputs</span><span class="p">,</span> <span class="n">TensorLike</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a term to multiply the gradient by to convert from &quot;*influence</span>
<span class="sd">        space*&quot; to &quot;*attribution space*&quot;. Conceptually, &quot;influence space&quot;</span>
<span class="sd">        corresponds to the potential effect of a slight increase in each</span>
<span class="sd">        feature, while &quot;attribution space&quot; corresponds to an approximation of</span>
<span class="sd">        the net marginal contribution to the quantity of interest of each</span>
<span class="sd">        feature.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            activation:</span>
<span class="sd">                The activation of the layer the DoI is applied to. DoI may be</span>
<span class="sd">                multi-input in which case activation will be a list.</span>
<span class="sd">            model_inputs:</span>
<span class="sd">                Optional wrapped model input arguments that produce activation</span>
<span class="sd">                at cut.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An array with the same shape as ``activation`` that will be</span>
<span class="sd">            multiplied by the gradient to obtain the attribution. The default</span>
<span class="sd">            implementation of this method simply returns ``activation``. If</span>
<span class="sd">            activation is multi-input, returns one multiplier for each.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">om_of_many</span><span class="p">(</span><span class="n">activation</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_assert_cut_contains_only_one_tensor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">DATA_CONTAINER_TYPE</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">MAP_CONTAINER_TYPE</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">DoiCutSupportError</span><span class="p">(</span>
                <span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span>
                <span class="s1">&#39;Cut provided to distribution of interest was comprised of &#39;</span>
                <span class="s1">&#39;multiple tensors, but `</span><span class="si">{}</span><span class="s1">` is only defined for cuts comprised &#39;</span>
                <span class="s1">&#39;of a single tensor (received a list of </span><span class="si">{}</span><span class="s1"> tensors).</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="s1">&#39;Either (1) select a slice where the `to_cut` corresponds to a &#39;</span>
                <span class="s1">&#39;single tensor, or (2) implement/use a `DoI` object that &#39;</span>
                <span class="s1">&#39;supports lists of tensors, i.e., where the parameter, `z`, to &#39;</span>
                <span class="s1">&#39;`__call__` is expected/allowed to be a list of </span><span class="si">{}</span><span class="s1"> tensors.&#39;</span><span class="o">.</span>
                <span class="nb">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
            <span class="p">)</span>

        <span class="k">elif</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">or</span> <span class="n">get_backend</span><span class="p">()</span><span class="o">.</span><span class="n">is_tensor</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s1">&#39;`</span><span class="si">{}</span><span class="s1">` expected to receive an instance of `Tensor` or &#39;</span>
                <span class="s1">&#39;`np.ndarray`, but received an instance of </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="trulens_explain.trulens.nn.distributions.DoI.__call__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">model_inputs</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

<a href="#trulens_explain.trulens.nn.distributions.DoI.__call__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Computes the distribution of interest from an initial point. If z:
TensorLike is given, we assume there is only 1 input to the DoI layer. If
z: List[TensorLike] is given, it provides all of the inputs to the DoI
layer. </p>
<p>Either way, we always return List[List[TensorLike]] (alias
Inputs[Uniform[TensorLike]]) with outer list spanning layer inputs, and
inner list spanning a distribution's instance.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>z</code></td>
          <td>
                <code><span title="trulens.utils.typing.OM">OM</span>[<span title="trulens.utils.typing.Inputs">Inputs</span>, <span title="trulens.utils.typing.TensorLike">TensorLike</span>]</code>
          </td>
          <td><p>Input point from which the distribution is derived. If
list/tuple, the point is defined by multiple tensors.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>model_inputs</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="trulens.utils.typing.ModelInputs">ModelInputs</span>]</code>
          </td>
          <td><p>Optional wrapped model input arguments that produce value z at
cut.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="trulens.utils.typing.OM">OM</span>[<span title="trulens.utils.typing.Inputs">Inputs</span>, <span title="trulens.utils.typing.Uniform">Uniform</span>[<span title="trulens.utils.typing.TensorLike">TensorLike</span>]]</code>
          </td>
          <td><p>List of points which are all assigned equal probability mass in the</p></td>
        </tr>
        <tr>
          <td>
                <code><span title="trulens.utils.typing.OM">OM</span>[<span title="trulens.utils.typing.Inputs">Inputs</span>, <span title="trulens.utils.typing.Uniform">Uniform</span>[<span title="trulens.utils.typing.TensorLike">TensorLike</span>]]</code>
          </td>
          <td><p>distribution of interest, i.e., the distribution of interest is a</p></td>
        </tr>
        <tr>
          <td>
                <code><span title="trulens.utils.typing.OM">OM</span>[<span title="trulens.utils.typing.Inputs">Inputs</span>, <span title="trulens.utils.typing.Uniform">Uniform</span>[<span title="trulens.utils.typing.TensorLike">TensorLike</span>]]</code>
          </td>
          <td><p>discrete, uniform distribution over the list of returned points. If</p></td>
        </tr>
        <tr>
          <td>
                <code><span title="trulens.utils.typing.OM">OM</span>[<span title="trulens.utils.typing.Inputs">Inputs</span>, <span title="trulens.utils.typing.Uniform">Uniform</span>[<span title="trulens.utils.typing.TensorLike">TensorLike</span>]]</code>
          </td>
          <td><p>z is multi-input, returns a distribution for each input.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>trulens_explain/trulens/nn/distributions.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">z</span><span class="p">:</span> <span class="n">OM</span><span class="p">[</span><span class="n">Inputs</span><span class="p">,</span> <span class="n">TensorLike</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">model_inputs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ModelInputs</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OM</span><span class="p">[</span><span class="n">Inputs</span><span class="p">,</span> <span class="n">Uniform</span><span class="p">[</span><span class="n">TensorLike</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the distribution of interest from an initial point. If z:</span>
<span class="sd">    TensorLike is given, we assume there is only 1 input to the DoI layer. If</span>
<span class="sd">    z: List[TensorLike] is given, it provides all of the inputs to the DoI</span>
<span class="sd">    layer. </span>

<span class="sd">    Either way, we always return List[List[TensorLike]] (alias</span>
<span class="sd">    Inputs[Uniform[TensorLike]]) with outer list spanning layer inputs, and</span>
<span class="sd">    inner list spanning a distribution&#39;s instance.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        z:</span>
<span class="sd">            Input point from which the distribution is derived. If</span>
<span class="sd">            list/tuple, the point is defined by multiple tensors.</span>
<span class="sd">        model_inputs:</span>
<span class="sd">            Optional wrapped model input arguments that produce value z at</span>
<span class="sd">            cut.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of points which are all assigned equal probability mass in the</span>
<span class="sd">        distribution of interest, i.e., the distribution of interest is a</span>
<span class="sd">        discrete, uniform distribution over the list of returned points. If</span>
<span class="sd">        z is multi-input, returns a distribution for each input.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="trulens_explain.trulens.nn.distributions.DoI.__init__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">cut</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#trulens_explain.trulens.nn.distributions.DoI.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>"Initialize DoI</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>cut</code></td>
          <td>
                <code><span title="trulens.nn.slices.Cut">Cut</span></code>
          </td>
          <td><p>The Cut in which the DoI will be applied. If <code>None</code>, the DoI will be
applied to the input. otherwise, the distribution should be applied
to the latent space defined by the cut.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>trulens_explain/trulens/nn/distributions.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cut</span><span class="p">:</span> <span class="n">Cut</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;&quot;Initialize DoI</span>

<span class="sd">    Parameters:</span>
<span class="sd">        cut (Cut, optional): </span>
<span class="sd">            The Cut in which the DoI will be applied. If `None`, the DoI will be</span>
<span class="sd">            applied to the input. otherwise, the distribution should be applied</span>
<span class="sd">            to the latent space defined by the cut. </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_cut</span> <span class="o">=</span> <span class="n">cut</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="trulens_explain.trulens.nn.distributions.DoI.cut" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">cut</span><span class="p">()</span></code>

<a href="#trulens_explain.trulens.nn.distributions.DoI.cut" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="trulens.nn.slices.Cut">Cut</span></code>
          </td>
          <td><p>The Cut in which the DoI will be applied. If <code>None</code>, the DoI will be</p></td>
        </tr>
        <tr>
          <td>
                <code><span title="trulens.nn.slices.Cut">Cut</span></code>
          </td>
          <td><p>applied to the input. otherwise, the distribution should be applied</p></td>
        </tr>
        <tr>
          <td>
                <code><span title="trulens.nn.slices.Cut">Cut</span></code>
          </td>
          <td><p>to the latent space defined by the cut.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>trulens_explain/trulens/nn/distributions.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">cut</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Cut</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns:</span>
<span class="sd">        The Cut in which the DoI will be applied. If `None`, the DoI will be</span>
<span class="sd">        applied to the input. otherwise, the distribution should be applied</span>
<span class="sd">        to the latent space defined by the cut. </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cut</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="trulens_explain.trulens.nn.distributions.DoI.get_activation_multiplier" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">get_activation_multiplier</span><span class="p">(</span><span class="n">activation</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">model_inputs</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#trulens_explain.trulens.nn.distributions.DoI.get_activation_multiplier" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Returns a term to multiply the gradient by to convert from "<em>influence
space</em>" to "<em>attribution space</em>". Conceptually, "influence space"
corresponds to the potential effect of a slight increase in each
feature, while "attribution space" corresponds to an approximation of
the net marginal contribution to the quantity of interest of each
feature.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>activation</code></td>
          <td>
                <code><span title="trulens.utils.typing.OM">OM</span>[<span title="trulens.utils.typing.Inputs">Inputs</span>, <span title="trulens.utils.typing.TensorLike">TensorLike</span>]</code>
          </td>
          <td><p>The activation of the layer the DoI is applied to. DoI may be
multi-input in which case activation will be a list.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>model_inputs</code></td>
          <td>
                <code><span title="typing.Optional">Optional</span>[<span title="trulens.utils.typing.ModelInputs">ModelInputs</span>]</code>
          </td>
          <td><p>Optional wrapped model input arguments that produce activation
at cut.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="trulens.utils.typing.OM">OM</span>[<span title="trulens.utils.typing.Inputs">Inputs</span>, <span title="trulens.utils.typing.TensorLike">TensorLike</span>]</code>
          </td>
          <td><p>An array with the same shape as <code>activation</code> that will be</p></td>
        </tr>
        <tr>
          <td>
                <code><span title="trulens.utils.typing.OM">OM</span>[<span title="trulens.utils.typing.Inputs">Inputs</span>, <span title="trulens.utils.typing.TensorLike">TensorLike</span>]</code>
          </td>
          <td><p>multiplied by the gradient to obtain the attribution. The default</p></td>
        </tr>
        <tr>
          <td>
                <code><span title="trulens.utils.typing.OM">OM</span>[<span title="trulens.utils.typing.Inputs">Inputs</span>, <span title="trulens.utils.typing.TensorLike">TensorLike</span>]</code>
          </td>
          <td><p>implementation of this method simply returns <code>activation</code>. If</p></td>
        </tr>
        <tr>
          <td>
                <code><span title="trulens.utils.typing.OM">OM</span>[<span title="trulens.utils.typing.Inputs">Inputs</span>, <span title="trulens.utils.typing.TensorLike">TensorLike</span>]</code>
          </td>
          <td><p>activation is multi-input, returns one multiplier for each.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>trulens_explain/trulens/nn/distributions.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_activation_multiplier</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">activation</span><span class="p">:</span> <span class="n">OM</span><span class="p">[</span><span class="n">Inputs</span><span class="p">,</span> <span class="n">TensorLike</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">model_inputs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ModelInputs</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OM</span><span class="p">[</span><span class="n">Inputs</span><span class="p">,</span> <span class="n">TensorLike</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a term to multiply the gradient by to convert from &quot;*influence</span>
<span class="sd">    space*&quot; to &quot;*attribution space*&quot;. Conceptually, &quot;influence space&quot;</span>
<span class="sd">    corresponds to the potential effect of a slight increase in each</span>
<span class="sd">    feature, while &quot;attribution space&quot; corresponds to an approximation of</span>
<span class="sd">    the net marginal contribution to the quantity of interest of each</span>
<span class="sd">    feature.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        activation:</span>
<span class="sd">            The activation of the layer the DoI is applied to. DoI may be</span>
<span class="sd">            multi-input in which case activation will be a list.</span>
<span class="sd">        model_inputs:</span>
<span class="sd">            Optional wrapped model input arguments that produce activation</span>
<span class="sd">            at cut.</span>

<span class="sd">    Returns:</span>
<span class="sd">        An array with the same shape as ``activation`` that will be</span>
<span class="sd">        multiplied by the gradient to obtain the attribution. The default</span>
<span class="sd">        implementation of this method simply returns ``activation``. If</span>
<span class="sd">        activation is multi-input, returns one multiplier for each.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">om_of_many</span><span class="p">(</span><span class="n">activation</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="trulens_explain.trulens.nn.distributions.DoiCutSupportError" class="doc doc-heading">
        <code>DoiCutSupportError</code>


<a href="#trulens_explain.trulens.nn.distributions.DoiCutSupportError" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code>ValueError</code></p>

  
      <p>Exception raised if the distribution of interest is called on a cut whose
output is not supported by the distribution of interest.</p>


        <details class="quote">
          <summary>Source code in <code>trulens_explain/trulens/nn/distributions.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">DoiCutSupportError</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Exception raised if the distribution of interest is called on a cut whose</span>
<span class="sd">    output is not supported by the distribution of interest.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
        </details>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="trulens_explain.trulens.nn.distributions.GaussianDoi" class="doc doc-heading">
        <code>GaussianDoi</code>


<a href="#trulens_explain.trulens.nn.distributions.GaussianDoi" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="trulens_explain.trulens.nn.distributions.DoI" href="#trulens_explain.trulens.nn.distributions.DoI">DoI</a></code></p>

  
      <p>Distribution representing a Gaussian ball around the point. Used by Smooth
Gradients.</p>


        <details class="quote">
          <summary>Source code in <code>trulens_explain/trulens/nn/distributions.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">GaussianDoi</span><span class="p">(</span><span class="n">DoI</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Distribution representing a Gaussian ball around the point. Used by Smooth</span>
<span class="sd">    Gradients.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">resolution</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">cut</span><span class="p">:</span> <span class="n">Cut</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters:</span>
<span class="sd">            var:</span>
<span class="sd">                The variance of the Gaussian noise to be added around the point.</span>

<span class="sd">            resolution:</span>
<span class="sd">                Number of samples returned by each call to this DoI.</span>
<span class="sd">            cut (Cut, optional): </span>
<span class="sd">                The Cut in which the DoI will be applied. If `None`, the DoI will be</span>
<span class="sd">                applied to the input. otherwise, the distribution should be applied</span>
<span class="sd">                to the latent space defined by the cut. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">GaussianDoi</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">cut</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_var</span> <span class="o">=</span> <span class="n">var</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_resolution</span> <span class="o">=</span> <span class="n">resolution</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">render_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;_cut&#39;</span><span class="p">,</span> <span class="s1">&#39;_var&#39;</span><span class="p">,</span> <span class="s1">&#39;_resolution&#39;</span><span class="p">])</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="n">OM</span><span class="p">[</span><span class="n">Inputs</span><span class="p">,</span>
                             <span class="n">TensorLike</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">OM</span><span class="p">[</span><span class="n">Inputs</span><span class="p">,</span> <span class="n">Uniform</span><span class="p">[</span><span class="n">TensorLike</span><span class="p">]]:</span>
        <span class="c1"># Public interface.</span>

        <span class="n">B</span> <span class="o">=</span> <span class="n">get_backend</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_cut_contains_only_one_tensor</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">gauss_of_input</span><span class="p">(</span><span class="n">z</span><span class="p">:</span> <span class="n">TensorLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Uniform</span><span class="p">[</span><span class="n">TensorLike</span><span class="p">]:</span>
            <span class="c1"># TODO: make a pytorch backend with the same interface to use in places like these.</span>

            <span class="k">if</span> <span class="n">B</span><span class="o">.</span><span class="n">is_tensor</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
                <span class="c1"># Tensor implementation.</span>
                <span class="k">return</span> <span class="p">[</span>
                    <span class="n">z</span> <span class="o">+</span> <span class="n">B</span><span class="o">.</span><span class="n">random_normal_like</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_var</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_resolution</span><span class="p">)</span>
                <span class="p">]</span>  <span class="c1"># Uniform</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Array implementation.</span>
                <span class="k">return</span> <span class="p">[</span>
                    <span class="n">z</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_var</span><span class="p">),</span> <span class="n">z</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_resolution</span><span class="p">)</span>
                <span class="p">]</span>  <span class="c1"># Uniform</span>

        <span class="n">z</span><span class="p">:</span> <span class="n">Inputs</span><span class="p">[</span><span class="n">TensorLike</span><span class="p">]</span> <span class="o">=</span> <span class="n">many_of_om</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">om_of_many</span><span class="p">(</span><span class="n">nested_map</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">gauss_of_input</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="trulens_explain.trulens.nn.distributions.GaussianDoi.__init__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">resolution</span><span class="p">,</span> <span class="n">cut</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#trulens_explain.trulens.nn.distributions.GaussianDoi.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>var</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p>The variance of the Gaussian noise to be added around the point.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>resolution</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of samples returned by each call to this DoI.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cut</code></td>
          <td>
                <code><span title="trulens.nn.slices.Cut">Cut</span></code>
          </td>
          <td><p>The Cut in which the DoI will be applied. If <code>None</code>, the DoI will be
applied to the input. otherwise, the distribution should be applied
to the latent space defined by the cut.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>trulens_explain/trulens/nn/distributions.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">resolution</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">cut</span><span class="p">:</span> <span class="n">Cut</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parameters:</span>
<span class="sd">        var:</span>
<span class="sd">            The variance of the Gaussian noise to be added around the point.</span>

<span class="sd">        resolution:</span>
<span class="sd">            Number of samples returned by each call to this DoI.</span>
<span class="sd">        cut (Cut, optional): </span>
<span class="sd">            The Cut in which the DoI will be applied. If `None`, the DoI will be</span>
<span class="sd">            applied to the input. otherwise, the distribution should be applied</span>
<span class="sd">            to the latent space defined by the cut. </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">GaussianDoi</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">cut</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_var</span> <span class="o">=</span> <span class="n">var</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_resolution</span> <span class="o">=</span> <span class="n">resolution</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="trulens_explain.trulens.nn.distributions.LinearDoi" class="doc doc-heading">
        <code>LinearDoi</code>


<a href="#trulens_explain.trulens.nn.distributions.LinearDoi" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="trulens_explain.trulens.nn.distributions.DoI" href="#trulens_explain.trulens.nn.distributions.DoI">DoI</a></code></p>

  
      <p>Distribution representing the linear interpolation between a baseline and 
the given point. Used by Integrated Gradients.</p>


        <details class="quote">
          <summary>Source code in <code>trulens_explain/trulens/nn/distributions.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">LinearDoi</span><span class="p">(</span><span class="n">DoI</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Distribution representing the linear interpolation between a baseline and </span>
<span class="sd">    the given point. Used by Integrated Gradients.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">baseline</span><span class="p">:</span> <span class="n">BaselineLike</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">resolution</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">cut</span><span class="p">:</span> <span class="n">Cut</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The DoI for point, `z`, will be a uniform distribution over the points</span>
<span class="sd">        on the line segment connecting `z` to `baseline`, approximated by a</span>
<span class="sd">        sample of `resolution` points equally spaced along this segment.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            cut (Cut, optional, from DoI): </span>
<span class="sd">                The Cut in which the DoI will be applied. If `None`, the DoI</span>
<span class="sd">                will be applied to the input. otherwise, the distribution should</span>
<span class="sd">                be applied to the latent space defined by the cut. </span>
<span class="sd">            baseline (BaselineLike, optional):</span>
<span class="sd">                The baseline to interpolate from. Must be same shape as the</span>
<span class="sd">                space the distribution acts over, i.e., the shape of the points,</span>
<span class="sd">                `z`, eventually passed to `__call__`. If `cut` is `None`, this</span>
<span class="sd">                must be the same shape as the input, otherwise this must be the</span>
<span class="sd">                same shape as the latent space defined by the cut. If `None` is</span>
<span class="sd">                given, `baseline` will be the zero vector in the appropriate</span>
<span class="sd">                shape. If the baseline is callable, it is expected to return the</span>
<span class="sd">                `baseline`, given `z` and optional model arguments.</span>
<span class="sd">            resolution (int):</span>
<span class="sd">                Number of points returned by each call to this DoI. A higher</span>
<span class="sd">                resolution is more computationally expensive, but gives a better</span>
<span class="sd">                approximation of the DoI this object mathematically represents.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">LinearDoi</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">cut</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_baseline</span> <span class="o">=</span> <span class="n">baseline</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_resolution</span> <span class="o">=</span> <span class="n">resolution</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">baseline</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BaselineLike</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_baseline</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">resolution</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resolution</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">render_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;_cut&#39;</span><span class="p">,</span> <span class="s1">&#39;_baseline&#39;</span><span class="p">,</span> <span class="s1">&#39;_resolution&#39;</span><span class="p">])</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">z</span><span class="p">:</span> <span class="n">OM</span><span class="p">[</span><span class="n">Inputs</span><span class="p">,</span> <span class="n">TensorLike</span><span class="p">],</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">model_inputs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ModelInputs</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OM</span><span class="p">[</span><span class="n">Inputs</span><span class="p">,</span> <span class="n">Uniform</span><span class="p">[</span><span class="n">TensorLike</span><span class="p">]]:</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_cut_contains_only_one_tensor</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

        <span class="n">z</span><span class="p">:</span> <span class="n">Inputs</span><span class="p">[</span><span class="n">TensorLike</span><span class="p">]</span> <span class="o">=</span> <span class="n">many_of_om</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

        <span class="n">baseline</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_baseline</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">model_inputs</span><span class="o">=</span><span class="n">model_inputs</span><span class="p">)</span>

        <span class="n">r</span> <span class="o">=</span> <span class="mf">1.</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resolution</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_resolution</span> <span class="o">-</span> <span class="mf">1.</span>
        <span class="n">zipped</span> <span class="o">=</span> <span class="n">nested_zip</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">baseline</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">zipped_interpolate</span><span class="p">(</span><span class="n">zipped_z_baseline</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;interpolates zipped elements</span>

<span class="sd">            Args:</span>
<span class="sd">                zipped_z_baseline: A tuple expecting the first element to be the z_val, and second to be the baseline.</span>

<span class="sd">            Returns:</span>
<span class="sd">                a list of interpolations from z to baseline</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">z_</span> <span class="o">=</span> <span class="n">zipped_z_baseline</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">b_</span> <span class="o">=</span> <span class="n">zipped_z_baseline</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">return</span> <span class="p">[</span> <span class="c1"># Uniform</span>
                <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">i</span> <span class="o">/</span> <span class="n">r</span><span class="p">)</span> <span class="o">*</span> <span class="n">z_</span> <span class="o">+</span> <span class="n">i</span> <span class="o">/</span> <span class="n">r</span> <span class="o">*</span> <span class="n">b_</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_resolution</span><span class="p">)</span>
            <span class="p">]</span>

        <span class="n">ret</span> <span class="o">=</span> <span class="n">om_of_many</span><span class="p">(</span>
            <span class="n">nested_map</span><span class="p">(</span>
                <span class="n">zipped</span><span class="p">,</span> <span class="n">zipped_interpolate</span><span class="p">,</span> <span class="n">check_accessor</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">def</span> <span class="nf">get_activation_multiplier</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">activation</span><span class="p">:</span> <span class="n">OM</span><span class="p">[</span><span class="n">Inputs</span><span class="p">,</span> <span class="n">TensorLike</span><span class="p">],</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">model_inputs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ModelInputs</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Inputs</span><span class="p">[</span><span class="n">TensorLike</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a term to multiply the gradient by to convert from &quot;*influence </span>
<span class="sd">        space*&quot; to &quot;*attribution space*&quot;. Conceptually, &quot;influence space&quot;</span>
<span class="sd">        corresponds to the potential effect of a slight increase in each </span>
<span class="sd">        feature, while &quot;attribution space&quot; corresponds to an approximation of</span>
<span class="sd">        the net marginal contribution to the quantity of interest of each </span>
<span class="sd">        feature.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            activation:</span>
<span class="sd">                The activation of the layer the DoI is applied to.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The activation adjusted by the baseline passed to the constructor.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">activation</span><span class="p">:</span> <span class="n">Inputs</span><span class="p">[</span><span class="n">TensorLike</span><span class="p">]</span> <span class="o">=</span> <span class="n">many_of_om</span><span class="p">(</span><span class="n">activation</span><span class="p">)</span>

        <span class="n">baseline</span><span class="p">:</span> <span class="n">Inputs</span><span class="p">[</span><span class="n">TensorLike</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_baseline</span><span class="p">(</span>
            <span class="n">activation</span><span class="p">,</span> <span class="n">model_inputs</span><span class="o">=</span><span class="n">model_inputs</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">baseline</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">activation</span>

        <span class="n">zipped</span> <span class="o">=</span> <span class="n">nested_zip</span><span class="p">(</span><span class="n">activation</span><span class="p">,</span> <span class="n">baseline</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">zipped_subtract</span><span class="p">(</span><span class="n">zipped_activation_baseline</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;subtracts zipped elements</span>

<span class="sd">            Args:</span>
<span class="sd">                zipped_activation_baseline: A tuple expecting the first element to be the activation, and second to be the baseline.</span>

<span class="sd">            Returns:</span>
<span class="sd">                a subtraction of activation and baseline</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">activation</span> <span class="o">=</span> <span class="n">zipped_activation_baseline</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">baseline</span> <span class="o">=</span> <span class="n">zipped_activation_baseline</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">activation</span> <span class="o">-</span> <span class="n">baseline</span>

        <span class="n">ret</span> <span class="o">=</span> <span class="n">nested_map</span><span class="p">(</span><span class="n">zipped</span><span class="p">,</span> <span class="n">zipped_subtract</span><span class="p">,</span> <span class="n">check_accessor</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">def</span> <span class="nf">_compute_baseline</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">z</span><span class="p">:</span> <span class="n">Inputs</span><span class="p">[</span><span class="n">TensorLike</span><span class="p">],</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">model_inputs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ModelInputs</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Inputs</span><span class="p">[</span><span class="n">TensorLike</span><span class="p">]:</span>

        <span class="n">B</span> <span class="o">=</span> <span class="n">get_backend</span><span class="p">()</span>

        <span class="n">_baseline</span><span class="p">:</span> <span class="n">BaselineLike</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">baseline</span>  <span class="c1"># user-provided</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">_baseline</span><span class="p">,</span> <span class="n">Callable</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">accepts_model_inputs</span><span class="p">(</span><span class="n">_baseline</span><span class="p">):</span>
                <span class="n">_baseline</span><span class="p">:</span> <span class="n">OM</span><span class="p">[</span><span class="n">Inputs</span><span class="p">,</span> <span class="n">TensorLike</span><span class="p">]</span> <span class="o">=</span> <span class="n">many_of_om</span><span class="p">(</span>
                    <span class="n">_baseline</span><span class="p">(</span><span class="n">om_of_many</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="n">model_inputs</span><span class="o">=</span><span class="n">model_inputs</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">_baseline</span><span class="p">:</span> <span class="n">OM</span><span class="p">[</span><span class="n">Inputs</span><span class="p">,</span> <span class="n">TensorLike</span><span class="p">]</span> <span class="o">=</span> <span class="n">many_of_om</span><span class="p">(</span>
                    <span class="n">_baseline</span><span class="p">(</span><span class="n">om_of_many</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
                <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">_baseline</span><span class="p">:</span> <span class="n">OM</span><span class="p">[</span><span class="n">Inputs</span><span class="p">,</span> <span class="n">TensorLike</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">_baseline</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_baseline</span><span class="p">:</span> <span class="n">Inputs</span><span class="p">[</span><span class="n">TensorLike</span><span class="p">]</span> <span class="o">=</span> <span class="n">nested_map</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">B</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_baseline</span><span class="p">:</span> <span class="n">Inputs</span><span class="p">[</span><span class="n">TensorLike</span><span class="p">]</span> <span class="o">=</span> <span class="n">many_of_om</span><span class="p">(</span><span class="n">_baseline</span><span class="p">)</span>
            <span class="c1"># Came from user; could have been single or multiple inputs.</span>
        <span class="n">tensor_wrapper</span> <span class="o">=</span> <span class="n">TensorAKs</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="n">z</span><span class="p">)</span>
        <span class="c1"># Cast to either Tensor or numpy.ndarray to match what was given in z.</span>
        <span class="k">return</span> <span class="n">nested_cast</span><span class="p">(</span>
            <span class="n">backend</span><span class="o">=</span><span class="n">B</span><span class="p">,</span>
            <span class="n">args</span><span class="o">=</span><span class="n">_baseline</span><span class="p">,</span>
            <span class="n">astype</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="n">tensor_wrapper</span><span class="o">.</span><span class="n">first_batchable</span><span class="p">(</span><span class="n">B</span><span class="p">))</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="trulens_explain.trulens.nn.distributions.LinearDoi.__init__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">baseline</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">cut</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#trulens_explain.trulens.nn.distributions.LinearDoi.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>The DoI for point, <code>z</code>, will be a uniform distribution over the points
on the line segment connecting <code>z</code> to <code>baseline</code>, approximated by a
sample of <code>resolution</code> points equally spaced along this segment.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>cut</code></td>
          <td>
                <code>Cut, optional, from DoI</code>
          </td>
          <td><p>The Cut in which the DoI will be applied. If <code>None</code>, the DoI
will be applied to the input. otherwise, the distribution should
be applied to the latent space defined by the cut. </p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>baseline</code></td>
          <td>
                <code><span title="trulens.utils.typing.BaselineLike">BaselineLike</span></code>
          </td>
          <td><p>The baseline to interpolate from. Must be same shape as the
space the distribution acts over, i.e., the shape of the points,
<code>z</code>, eventually passed to <code>__call__</code>. If <code>cut</code> is <code>None</code>, this
must be the same shape as the input, otherwise this must be the
same shape as the latent space defined by the cut. If <code>None</code> is
given, <code>baseline</code> will be the zero vector in the appropriate
shape. If the baseline is callable, it is expected to return the
<code>baseline</code>, given <code>z</code> and optional model arguments.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>resolution</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of points returned by each call to this DoI. A higher
resolution is more computationally expensive, but gives a better
approximation of the DoI this object mathematically represents.</p></td>
          <td>
                <code>10</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>trulens_explain/trulens/nn/distributions.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">baseline</span><span class="p">:</span> <span class="n">BaselineLike</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">resolution</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">cut</span><span class="p">:</span> <span class="n">Cut</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The DoI for point, `z`, will be a uniform distribution over the points</span>
<span class="sd">    on the line segment connecting `z` to `baseline`, approximated by a</span>
<span class="sd">    sample of `resolution` points equally spaced along this segment.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        cut (Cut, optional, from DoI): </span>
<span class="sd">            The Cut in which the DoI will be applied. If `None`, the DoI</span>
<span class="sd">            will be applied to the input. otherwise, the distribution should</span>
<span class="sd">            be applied to the latent space defined by the cut. </span>
<span class="sd">        baseline (BaselineLike, optional):</span>
<span class="sd">            The baseline to interpolate from. Must be same shape as the</span>
<span class="sd">            space the distribution acts over, i.e., the shape of the points,</span>
<span class="sd">            `z`, eventually passed to `__call__`. If `cut` is `None`, this</span>
<span class="sd">            must be the same shape as the input, otherwise this must be the</span>
<span class="sd">            same shape as the latent space defined by the cut. If `None` is</span>
<span class="sd">            given, `baseline` will be the zero vector in the appropriate</span>
<span class="sd">            shape. If the baseline is callable, it is expected to return the</span>
<span class="sd">            `baseline`, given `z` and optional model arguments.</span>
<span class="sd">        resolution (int):</span>
<span class="sd">            Number of points returned by each call to this DoI. A higher</span>
<span class="sd">            resolution is more computationally expensive, but gives a better</span>
<span class="sd">            approximation of the DoI this object mathematically represents.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">LinearDoi</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">cut</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_baseline</span> <span class="o">=</span> <span class="n">baseline</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_resolution</span> <span class="o">=</span> <span class="n">resolution</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="trulens_explain.trulens.nn.distributions.LinearDoi.get_activation_multiplier" class="doc doc-heading">
<code class="codehilite language-python"><span class="n">get_activation_multiplier</span><span class="p">(</span><span class="n">activation</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">model_inputs</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#trulens_explain.trulens.nn.distributions.LinearDoi.get_activation_multiplier" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Returns a term to multiply the gradient by to convert from "<em>influence 
space</em>" to "<em>attribution space</em>". Conceptually, "influence space"
corresponds to the potential effect of a slight increase in each 
feature, while "attribution space" corresponds to an approximation of
the net marginal contribution to the quantity of interest of each 
feature.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>activation</code></td>
          <td>
                <code><span title="trulens.utils.typing.OM">OM</span>[<span title="trulens.utils.typing.Inputs">Inputs</span>, <span title="trulens.utils.typing.TensorLike">TensorLike</span>]</code>
          </td>
          <td><p>The activation of the layer the DoI is applied to.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="trulens.utils.typing.Inputs">Inputs</span>[<span title="trulens.utils.typing.TensorLike">TensorLike</span>]</code>
          </td>
          <td><p>The activation adjusted by the baseline passed to the constructor.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>trulens_explain/trulens/nn/distributions.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_activation_multiplier</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">activation</span><span class="p">:</span> <span class="n">OM</span><span class="p">[</span><span class="n">Inputs</span><span class="p">,</span> <span class="n">TensorLike</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">model_inputs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ModelInputs</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Inputs</span><span class="p">[</span><span class="n">TensorLike</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a term to multiply the gradient by to convert from &quot;*influence </span>
<span class="sd">    space*&quot; to &quot;*attribution space*&quot;. Conceptually, &quot;influence space&quot;</span>
<span class="sd">    corresponds to the potential effect of a slight increase in each </span>
<span class="sd">    feature, while &quot;attribution space&quot; corresponds to an approximation of</span>
<span class="sd">    the net marginal contribution to the quantity of interest of each </span>
<span class="sd">    feature.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        activation:</span>
<span class="sd">            The activation of the layer the DoI is applied to.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The activation adjusted by the baseline passed to the constructor.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">activation</span><span class="p">:</span> <span class="n">Inputs</span><span class="p">[</span><span class="n">TensorLike</span><span class="p">]</span> <span class="o">=</span> <span class="n">many_of_om</span><span class="p">(</span><span class="n">activation</span><span class="p">)</span>

    <span class="n">baseline</span><span class="p">:</span> <span class="n">Inputs</span><span class="p">[</span><span class="n">TensorLike</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_baseline</span><span class="p">(</span>
        <span class="n">activation</span><span class="p">,</span> <span class="n">model_inputs</span><span class="o">=</span><span class="n">model_inputs</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">baseline</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">activation</span>

    <span class="n">zipped</span> <span class="o">=</span> <span class="n">nested_zip</span><span class="p">(</span><span class="n">activation</span><span class="p">,</span> <span class="n">baseline</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">zipped_subtract</span><span class="p">(</span><span class="n">zipped_activation_baseline</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;subtracts zipped elements</span>

<span class="sd">        Args:</span>
<span class="sd">            zipped_activation_baseline: A tuple expecting the first element to be the activation, and second to be the baseline.</span>

<span class="sd">        Returns:</span>
<span class="sd">            a subtraction of activation and baseline</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">activation</span> <span class="o">=</span> <span class="n">zipped_activation_baseline</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">baseline</span> <span class="o">=</span> <span class="n">zipped_activation_baseline</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">activation</span> <span class="o">-</span> <span class="n">baseline</span>

    <span class="n">ret</span> <span class="o">=</span> <span class="n">nested_map</span><span class="p">(</span><span class="n">zipped</span><span class="p">,</span> <span class="n">zipped_subtract</span><span class="p">,</span> <span class="n">check_accessor</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">ret</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="trulens_explain.trulens.nn.distributions.PointDoi" class="doc doc-heading">
        <code>PointDoi</code>


<a href="#trulens_explain.trulens.nn.distributions.PointDoi" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code><a class="autorefs autorefs-internal" title="trulens_explain.trulens.nn.distributions.DoI" href="#trulens_explain.trulens.nn.distributions.DoI">DoI</a></code></p>

  
      <p>Distribution that puts all probability mass on a single point.</p>


        <details class="quote">
          <summary>Source code in <code>trulens_explain/trulens/nn/distributions.py</code></summary>
          <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">PointDoi</span><span class="p">(</span><span class="n">DoI</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Distribution that puts all probability mass on a single point.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cut</span><span class="p">:</span> <span class="n">Cut</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;&quot;Initialize PointDoI</span>

<span class="sd">        Parameters:</span>
<span class="sd">            cut (Cut, optional): </span>
<span class="sd">                The Cut in which the DoI will be applied. If `None`, the DoI will be</span>
<span class="sd">                applied to the input. otherwise, the distribution should be applied</span>
<span class="sd">                to the latent space defined by the cut. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">PointDoi</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">cut</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">z</span><span class="p">:</span> <span class="n">OM</span><span class="p">[</span><span class="n">Inputs</span><span class="p">,</span> <span class="n">TensorLike</span><span class="p">],</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">model_inputs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ModelInputs</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OM</span><span class="p">[</span><span class="n">Inputs</span><span class="p">,</span> <span class="n">Uniform</span><span class="p">[</span><span class="n">TensorLike</span><span class="p">]]:</span>

        <span class="n">z</span><span class="p">:</span> <span class="n">Inputs</span><span class="p">[</span><span class="n">TensorLike</span><span class="p">]</span> <span class="o">=</span> <span class="n">many_of_om</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">om_of_many</span><span class="p">(</span><span class="n">nested_map</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">[</span><span class="n">x</span><span class="p">]))</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="trulens_explain.trulens.nn.distributions.PointDoi.__init__" class="doc doc-heading">
<code class="codehilite language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">cut</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#trulens_explain.trulens.nn.distributions.PointDoi.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>"Initialize PointDoI</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>cut</code></td>
          <td>
                <code><span title="trulens.nn.slices.Cut">Cut</span></code>
          </td>
          <td><p>The Cut in which the DoI will be applied. If <code>None</code>, the DoI will be
applied to the input. otherwise, the distribution should be applied
to the latent space defined by the cut.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>trulens_explain/trulens/nn/distributions.py</code></summary>
        <div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cut</span><span class="p">:</span> <span class="n">Cut</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;&quot;Initialize PointDoI</span>

<span class="sd">    Parameters:</span>
<span class="sd">        cut (Cut, optional): </span>
<span class="sd">            The Cut in which the DoI will be applied. If `None`, the DoI will be</span>
<span class="sd">            applied to the input. otherwise, the distribution should be applied</span>
<span class="sd">            to the latent space defined by the cut. </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">PointDoi</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">cut</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "navigation.path", "search.share", "search.suggest", "toc.follow", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.19047be9.min.js"></script>
      
        <script src="../../../javascript/config.js"></script>
      
        <script src="../../../javascript/app.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="../../../javascript/tex-mml-chtml-3.0.0.js"></script>
      
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
      
    
  </body>
</html>